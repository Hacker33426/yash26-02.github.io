<!-- ðŸŽ® index.html --><!DOCTYPE html><html>
<head>
  <title>YGWIN - Wingo Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; background: #111; color: white; margin: 0; padding: 20px; }
    .card { background: #222; padding: 15px; border-radius: 10px; margin-bottom: 20px; }
    input, button { padding: 10px; border: none; border-radius: 8px; margin: 5px 0; width: 100%; }
    button { cursor: pointer; font-weight: bold; }
    .green { background: #43a047; color: white; }
    .red { background: #e53935; color: white; }
    .logout { background: #888; }
    .qr { background: white; padding: 10px; border-radius: 10px; }
  </style>
</head>
<body>
<div id="mainBox" style="display:none">
  <div class="card">
    <h3 id="period"></h3>
    <h4 id="timer"></h4>
    <h4 id="balance"></h4>
  </div>  <div class="card">
    <input type="number" id="betAmt" placeholder="Enter Bet Amount">
    <button class="red" onclick="placeBet('RED')">Bet RED</button>
    <button class="green" onclick="placeBet('GREEN')">Bet GREEN</button>
  </div>  <div class="card">
    <h4>Result: <span id="result">--</span></h4>
    <h4>History</h4>
    <ul id="history"></ul>
  </div>  <div class="card">
    <h3>Deposit</h3>
    <img id="qrImg" class="qr" width="200">
    <p>UPI ID: yashgolani26@fam</p>
    <input type="number" id="depositAmt" placeholder="Enter Amount">
    <input type="text" id="utr" placeholder="Enter 12-digit UTR">
    <button onclick="submitDeposit()">Submit for Approval</button>
  </div>  <div class="card">
    <h3>Withdraw</h3>
    <input type="number" id="withdrawAmt" placeholder="Enter Amount">
    <input type="text" id="upi" placeholder="Enter Your UPI ID">
    <button onclick="submitWithdraw()">Request Withdraw</button>
  </div><button class="logout" onclick="logout()">Logout</button>

</div><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script><script>
  const firebaseConfig = {
    apiKey: "AIzaSyCZFXeJZxc8CJiDz-KBLNKu6JW85LVgYjs",
    authDomain: "yash-first-64655.firebaseapp.com",
    databaseURL: "https://yash-first-64655-default-rtdb.firebaseio.com",
    projectId: "yash-first-64655",
    storageBucket: "yash-first-64655.appspot.com",
    messagingSenderId: "610242949077",
    appId: "1:610242949077:web:216a0905cf9850969f175c"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const user = localStorage.getItem("login");
  if (!user) window.location.href = "login.html";
  else document.getElementById("mainBox").style.display = 'block';

  let currentBet = null;

  function getPeriod(offset = 0) {
    const now = new Date();
    const mins = now.getUTCHours() * 60 + now.getUTCMinutes() + offset;
    return now.getUTCFullYear().toString() +
      String(now.getUTCMonth() + 1).padStart(2, '0') +
      String(now.getUTCDate()).padStart(2, '0') + "1000" + (10001 + mins);
  }

  function updateTimer() {
    const sec = new Date().getUTCSeconds();
    const rem = 60 - sec;
    const currentPeriod = getPeriod();
    const previousPeriod = getPeriod(-1);

    document.getElementById("period").innerText = "Period: " + currentPeriod;
    document.getElementById("timer").innerText = "Timer: 00:" + String(rem).padStart(2, '0');

    db.ref("manualResults/" + previousPeriod).once('value').then(snap => {
      const result = snap.exists() ? snap.val() : (Math.random() > 0.5 ? "RED" : "GREEN");
      document.getElementById("result").innerText = result;

      if (currentBet && currentBet.period === previousPeriod) {
        if (currentBet.color === result) {
          const win = currentBet.amt + (currentBet.amt * 0.96);
          db.ref("users/" + user + "/balance").set(firebase.database.ServerValue.increment(win));
          alert("You WON â‚¹" + win.toFixed(2));
        } else {
          alert("You LOST â‚¹" + currentBet.amt);
        }
        currentBet = null;
      }

      db.ref("history/" + previousPeriod).set(result);
      loadHistory();
    });
  }
  setInterval(updateTimer, 1000);

  function placeBet(color) {
    const amt = parseFloat(document.getElementById("betAmt").value);
    if (!amt || amt <= 0) return alert("Enter valid amount");
    db.ref("users/" + user + "/balance").once('value').then(snap => {
      if (snap.val() >= amt) {
        db.ref("users/" + user + "/balance").set(snap.val() - amt);
        currentBet = { color, amt, period: getPeriod() };
        alert("Bet placed on " + color);
      } else {
        alert("Insufficient balance");
      }
    });
  }

  function loadBalance() {
    db.ref("users/" + user + "/balance").on('value', snap => {
      document.getElementById("balance").innerText = "Wallet Balance: â‚¹" + (snap.val() || 0).toFixed(2);
    });
  }

  function loadQR() {
    db.ref("qr").on('value', snap => {
      if (snap.exists()) document.getElementById("qrImg").src = snap.val();
    });
  }

  function submitDeposit() {
    const amt = parseFloat(document.getElementById("depositAmt").value);
    const utr = document.getElementById("utr").value;
    if (utr.length !== 12) return alert("Invalid UTR");
    db.ref("depositRequests").push({ user, amt, utr, status: "pending" });
    alert("Deposit Request Sent");
  }

  function submitWithdraw() {
    const amt = parseFloat(document.getElementById("withdrawAmt").value);
    const upi = document.getElementById("upi").value;
    if (!upi) return alert("Enter UPI ID");
    db.ref("withdrawRequests").push({ user, amt, upi, status: "pending" });
    alert("Withdrawal Request Sent");
  }

  function logout() {
    localStorage.removeItem("login");
    window.location.href = "login.html";
  }

  function loadHistory() {
    db.ref("history").limitToLast(10).once('value').then(snap => {
      const list = document.getElementById("history");
      list.innerHTML = "";
      const data = snap.val();
      if (data) {
        Object.entries(data).reverse().forEach(([k, v]) => {
          const li = document.createElement("li");
          li.innerText = k + " = " + v;
          list.appendChild(li);
        });
      }
    });
  }

  loadBalance();
  loadQR();
  loadHistory();
</script></body>
  </html>
