<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YGWIN - All in One</title>
  <style>
    body { font-family: sans-serif; background: #111; color: white; padding: 20px; margin: 0; }
    .card { background: #222; padding: 20px; border-radius: 10px; margin: 10px auto; max-width: 400px; }
    .btn { padding: 12px; width: 100%; margin: 5px 0; border: none; border-radius: 8px; font-weight: bold; font-size: 16px; }
    .red { background: crimson; color: white; }
    .green { background: limegreen; color: white; }
    .logout { background: #555; color: white; margin-top: 10px; }
    input { width: 100%; padding: 10px; margin: 5px 0; border-radius: 6px; border: none; }
    .hidden { display: none; }
    img.qr { width: 100%; margin: 10px 0; border-radius: 10px; }
    .history-item { padding: 4px 0; font-size: 14px; }
    a { color: #0af; cursor: pointer; text-decoration: underline; }
  </style>
</head>
<body>
<div class="card" id="authBox">
  <h2 id="authTitle">Register</h2>
  <input id="authNumber" placeholder="Enter Phone Number">
  <input id="authPassword" type="password" placeholder="Enter Password">
  <input id="authConfirm" type="password" placeholder="Confirm Password">
  <button class="btn" onclick="handleAuth()">Register</button>
  <p style="text-align:center;">
    <span id="toggleAuth">Already have an account? <a onclick="toggleAuthMode()">Login</a></span>
  </p>
</div><div class="card hidden" id="mainGame">
  <h2>Wingo 1-Minute Game</h2>
  <p id="period">Period: loading...</p>
  <p id="timer">Timer: --:--</p>
  <p id="wallet">Wallet: ₹0.00</p>
  <input id="betAmount" placeholder="Enter Bet Amount">
  <button class="btn red" onclick="placeBet('RED')">Bet RED</button>
  <button class="btn green" onclick="placeBet('GREEN')">Bet GREEN</button>
  <p id="result">Result: --</p>  <h3>History</h3>
  <div id="history"></div>  <h3>Deposit</h3>
  <img class="qr" id="qrImg" src="" alt="QR Code" />
  <p>UPI ID: yashgolani26@fam</p>
  <input id="depositAmt" placeholder="Enter Amount">
  <input id="utr" placeholder="Enter 12-digit UTR">
  <button class="btn" onclick="submitDeposit()">Submit for Approval</button>  <h3>Withdraw</h3>
  <input id="withdrawAmt" placeholder="Enter Amount">
  <input id="withdrawUpi" placeholder="Enter your UPI ID">
  <button class="btn" onclick="submitWithdraw()">Request Withdrawal</button><button class="btn logout" onclick="logout()">Logout</button>

</div><script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script><script>
  const firebaseConfig = {
    apiKey: "AIzaSyCZFXeJZxc8CJiDz-KBLNKu6JW85LVgYjs",
    authDomain: "yash-first-64655.firebaseapp.com",
    projectId: "yash-first-64655",
    storageBucket: "yash-first-64655.appspot.com",
    messagingSenderId: "610242949077",
    appId: "1:610242949077:web:216a0905cf9850969f175c",
    measurementId: "G-YL4KQQ4Z5Y"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let currentUser = null;
  let isLogin = false;

  function toggleAuthMode() {
    isLogin = !isLogin;
    document.getElementById("authTitle").innerText = isLogin ? "Login" : "Register";
    document.getElementById("authConfirm").style.display = isLogin ? "none" : "block";
    document.querySelector("#toggleAuth").innerHTML = isLogin
      ? "Don't have an account? <a onclick=\"toggleAuthMode()\">Register</a>"
      : "Already have an account? <a onclick=\"toggleAuthMode()\">Login</a>";
  }

  function handleAuth() {
    const num = document.getElementById("authNumber").value;
    const pass = document.getElementById("authPassword").value;
    const confirm = document.getElementById("authConfirm").value;
    if (!num || !pass || (!isLogin && pass !== confirm)) return alert("Invalid input");

    const userRef = db.ref("users/" + num);
    userRef.once("value", snap => {
      if (isLogin) {
        if (snap.exists() && snap.val().password === pass) {
          currentUser = num;
          localStorage.setItem("user", num);
          startGame();
        } else {
          alert("Invalid login");
        }
      } else {
        if (snap.exists()) return alert("Number already registered");
        userRef.set({ password: pass, balance: 0 });
        alert("Registration successful");
        toggleAuthMode();
      }
    });
  }

  function logout() {
    localStorage.removeItem("user");
    location.reload();
  }

  function startGame() {
    document.getElementById("authBox").classList.add("hidden");
    document.getElementById("mainGame").classList.remove("hidden");
    loadGame();
  }

  function loadGame() {
    const user = localStorage.getItem("user");
    if (!user) return;
    currentUser = user;
    db.ref("users/" + user).on("value", snap => {
      document.getElementById("wallet").innerText = "Wallet: ₹" + (snap.val().balance || 0);
    });
    db.ref("qr").on("value", snap => {
      document.getElementById("qrImg").src = snap.val() || "";
    });
    setInterval(updateTimerAndPeriod, 1000);
    loadHistory();
  }

  function getCurrentPeriod() {
    const now = new Date();
    const mins = now.getUTCHours() * 60 + now.getUTCMinutes();
    return now.getUTCFullYear() + ('0'+(now.getUTCMonth()+1)).slice(-2) + ('0'+now.getUTCDate()).slice(-2) + "1000" + (10001 + mins);
  }

  function updateTimerAndPeriod() {
    const now = new Date();
    const sec = now.getUTCSeconds();
    const rem = 60 - sec;
    document.getElementById("timer").innerText = "Timer: 00:" + (rem < 10 ? "0" : "") + rem;
    document.getElementById("period").innerText = "Period: " + getCurrentPeriod();
  }

  function placeBet(color) {
    const amt = parseFloat(document.getElementById("betAmount").value);
    if (!amt || amt <= 0) return alert("Enter valid amount");
    const period = getCurrentPeriod();
    const betRef = db.ref("bets/" + period + "/" + currentUser);
    betRef.set({ color: color, amount: amt });
    alert("Bet placed on " + color);
  }

  function submitDeposit() {
    const amt = parseFloat(document.getElementById("depositAmt").value);
    const utr = document.getElementById("utr").value;
    if (!amt || !utr || utr.length !== 12) return alert("Enter valid amount & UTR");
    const ref = db.ref("requests/deposit/").push();
    ref.set({ number: currentUser, amount: amt, utr: utr, status: "pending" });
    alert("Deposit request submitted");
  }

  function submitWithdraw() {
    const amt = parseFloat(document.getElementById("withdrawAmt").value);
    const upi = document.getElementById("withdrawUpi").value;
    if (!amt || !upi.includes("@")) return alert("Enter valid UPI and amount");
    const ref = db.ref("requests/withdraw/").push();
    ref.set({ number: currentUser, amount: amt, upi: upi, status: "pending" });
    alert("Withdraw request submitted");
  }

  function loadHistory() {
    db.ref("results").limitToLast(20).on("value", snap => {
      const container = document.getElementById("history");
      container.innerHTML = "";
      const items = [];
      snap.forEach(child => {
        items.unshift(`<div class='history-item'>${child.key} = ${child.val()}</div>`);
      });
      container.innerHTML = items.join("");
    });
  }

  window.onload = () => {
    const user = localStorage.getItem("user");
    if (user) {
      currentUser = user;
      startGame();
    }
  };
</script></body>
  </html>
